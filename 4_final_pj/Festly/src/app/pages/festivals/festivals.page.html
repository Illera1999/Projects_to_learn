<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>Festivales</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ion-header collapse="condense">
    <ion-toolbar>
      <ion-title size="large">Festivales</ion-title>
    </ion-toolbar>
  </ion-header>

    <ion-refresher
      slot="fixed"
      [disabled]="refresherDisabled()"
      (ionRefresh)="handleRefresh($event)"
    >
      <ion-refresher-content></ion-refresher-content>
    </ion-refresher>

  <div class="map-wrapper">
    <div
      #map
      class="gm-map"
      [hidden]="isMapLoading()"
      (touchstart)="onMapTouchStart()"
      (touchend)="onMapTouchEnd()"
      (touchcancel)="onMapTouchEnd()"
      (mousedown)="onMapTouchStart()"
      (mouseup)="onMapTouchEnd()"
      (mouseleave)="onMapTouchEnd()"
    ></div>
    @if (isMapLoading()) {
    <div class="map-loading-overlay">
      <ion-spinner name="crescent"></ion-spinner>
      <p>Cargando mapa...</p>
    </div>
    }
  </div>

  <ion-fab vertical="bottom" horizontal="end" slot="fixed">
    <ion-fab-button (click)="openGenreFilter()">
      
    </ion-fab-button>
  </ion-fab>

@if (selectedEvent()) {
<section class="selected-event">
  <ion-item class="selected-event__card">
    <ion-label>
      <h2 class="selected-event__title">
        {{ selectedEvent()?.eventName }}
      </h2>
      <p class="selected-event__place">
        {{ selectedEvent()?.place?.name }} 路
        {{ selectedEvent()?.place?.city }},
        {{ selectedEvent()?.place?.country }}
      </p>
      <p class="selected-event__date">
         {{ selectedEvent()?.date?.toDate() | date: 'longDate' }}
      </p>
    </ion-label>

    <ion-button
      fill="clear"
      size="small"
      class="selected-event__button"
      (click)="openDirectionsToEvent(selectedEvent())"
    >
      <ion-icon slot="start" name="navigate-outline"></ion-icon>
      C贸mo llegar
    </ion-button>
  </ion-item>
</section>
}

<ion-alert
  [isOpen]="showGenreFilter()"
  header="Filtrar por g茅nero"
  [inputs]="genreAlertInputs"
  [buttons]="genreAlertButtons"
  (didDismiss)="closeGenreFilter()"
></ion-alert>

<ion-toast
  [isOpen]="showNoLocationToast()"
  message="No hemos podido obtener tu ubicaci贸n actual. Revisa los permisos de localizaci贸n y vuelve a intentarlo."
  duration="2500"
  position="bottom"
  (didDismiss)="onNoLocationToastDismiss()"
></ion-toast>
</ion-content>
